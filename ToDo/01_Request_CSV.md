[MS-PL License]://opensource.org/licenses/ms-pl.html

## :cyclone: План разработки дополнения

* [ ] Перед открытием CSV создавать резервную копию
* [ ] Предотвратить удаление первых нулей
* [ ] Предотвратить преобразование чисел >1 с точкой (или слешем) в даты (заменить на формулу)
* [ ] Предотвратить преобразование чисел с плавающей точкой больше 16 знаков
* [ ] Перед открытием CSV изменять формат колонок
* [ ] Перед открытием CSV удалять пробелы перед *символом разделителя*
* [ ] Выявлять строку заголовка и применять к ней автофильтр
* [ ] Интервально читать данные из столбца и записывать в новую таблицу (учитывать количество колонок)
* [ ] Добавить в начале CSV строку `sep=;` на основании региональных настроек EU
* [ ] Изменять в CSV разделитель дробной части на основании региональных настроек EU
* [ ] Перед открытием CSV изменять формат дат на `YYYY-MM-DD`
* [ ] При наличии *символа разделителя* экранировать значения двойными кавычками
* [ ] Перед открытием CSV проверять наличие небезопасных данных `"=`
* [ ] Экранировать значение двойными кавычками если первым идёт специальный символ `=`

## :cyclone: Преобразование CSV в Excel (RFC 4180)

Формат CSV используется уже более 30 лет, но несмотря на его длительную историю, он никогда не был официально задокументирован. Название CSV (*Comma-Separated Values*) возникло из-за использования запятых для разделения полей данных.
Но это в теории. На самом деле, множество так называемых CSV-файлов используют другие символы для разделения данных, например:

* Табуляция – TSV-файлы (*tab-separated values*)
* Точка с запятой – SCSV-файлы (*semicolon separated values*)

Некоторые вариации файлов CSV разделяют поля данных одинарными или двойными кавычками, другие требуют маркер последовательности байтов из Юникода (BOM), например, UTF-8, для корректной интерпретации Юникода.
Это отсутствие стандартов порождает разнообразные проблемы, с которыми Вы можете столкнуться, пытаясь преобразовать файл Excel в CSV, и особенно, когда импортируете файл CSV в Excel.

Если Ваш файл CSV содержит численные данные или даты, Excel может преобразовать их с ошибками.

## :cyclone: Ссылки

1. [Язвы и грабли CSV и Excel](//habr.com/post/129476/ "RU, 2011-09-30")

# 
